<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock Paper Scissor</title>
</head>

<style>
    html {
      font-family: sans-serif;
    }
    body {
      width: 50%;
      max-width: 800px;
      min-width: 480px;
      margin: 0 auto;
      text-align: center;
    }
  </style>

<body>
    <h1>Rock, Paper, or Scissor?</h1>
    <div>
        <p>Pick your choice</p>
        <button id="rockBtn">Rock</button>
        <button id="paperBtn">Paper</button>
        <button id="scissorBtn">Scissor</button>
    </div>
    <div class="resultBoard">
        <p class="compChoice"></p>
        <p class="results"></p>
        <p class="scoreBoard"></p>
        <p class="gameLeft"></p>
        <p class="gameO"></p>
        <p class="playerW"></p>
    </div>
</body>

<script >
    const rockBtn = document.querySelector("#rockBtn")
    const paperBtn = document.querySelector("#paperBtn")
    const scissorBtn = document.querySelector("#scissorBtn")

    const compChoice = document.querySelector(".compChoice")
    const results = document.querySelector(".results")
    const scoreBoard = document.querySelector(".scoreBoard")
    const gameLeft = document.querySelector(".gameLeft")
    const gameO = document.querySelector(".gameO")
    const playerW = document.querySelector(".playerW")

    function getComputerChoice() {
        choice = Math.round(Math.random()*100)
        if (choice <= 33) {
            return "Rock"
        }
        else if (choice > 33 && choice <= 66) {
            return "Paper"
        } else {
            return "Scissor"
        }
    }

    function displayResult(computerChoice, humanChoice, res, humanScore, computerScore, gameCount){
        compChoice.textContent = `Computer choice: ${computerChoice}`
        if (res == "Win"){
            results.textContent = `You win! ${humanChoice} beats ${computerChoice}`
            results.style.backgroundColor = "green"
        }
        else if (res == "Lose"){
            results.textContent = `You lose! ${computerChoice} beats ${humanChoice}`
            results.style.backgroundColor = "red"
        }
        else {
            results.textContent = "You tied!"
            results.style.backgroundColor = "blue"
        }
        scoreBoard.textContent = `Your score: ${humanScore}     Computer score: ${computerScore}`
        gameLeft.textContent = `Game left: ${gameCount-1}`;
    }

    function gameOver(playerWin){
        gameO.textContent = "GAME OVER!"
        playerWin = true ? playerW.textContent = "You win!" : playerW.textContent = "You lose"
        gameO.style.fontSize = "bold";
        rockBtn.disabled = true;
        paperBtn.disabled = true;
        scissorBtn.disabled = true;
        resetButton = document.createElement("button")
        resetButton.textContent = "Start new game"
        document.body.appendChild(resetButton)
        resetButton.addEventListener("click", resetGame)
    }

    function resetGame(){
        document.body.removeChild(resetButton)
        rockBtn.disabled = false
        paperBtn.disabled = false
        scissorBtn.disabled = false
        resetResult = document.querySelectorAll('.resultBoard p')
        for (const result of resetResult){
            result.textContent = '';
        }
        playGame();
    }

    function playGame(){
        let humanScore = 0;
        let computerScore = 0;
        let gameCount = 5;

        function playRound(humanChoice){
            computerChoice = getComputerChoice()
            if ((humanChoice == "Rock" && computerChoice == "Scissor") ||
            (humanChoice == "Paper" && computerChoice == "Rock") ||
            (humanChoice == "Scissor" && computerChoice == "Paper")){
                humanScore += 1
                displayResult(computerChoice, humanChoice, "Win", humanScore, computerScore, gameCount)
            }
            else if ((humanChoice == "Rock" && computerChoice == "Paper") ||
            (humanChoice == "Paper" && computerChoice == "Scissor") ||
            (humanChoice == "Scissor" && computerChoice == "Rock")){
                computerScore += 1
                displayResult(computerChoice, humanChoice, "Lose", humanScore, computerScore, gameCount)
            }
            else {
                displayResult(computerChoice, humanChoice, "Tie", humanScore, computerScore, gameCount)
            }
            gameCount--;
            if (gameCount == 0){
                (humanScore > computerScore) ? gameOver(true) : gameOver(false)
            }
        }

        rockBtn.addEventListener("click", () => {playRound("Rock")})
        paperBtn.addEventListener("click", () => {playRound("Paper")})
        scissorBtn.addEventListener("click", () => {playRound("Scissor")})
    }

    playGame();

</script>

</html>
